<html>
  <head>
	 <meta charset="utf-8">
   <script src="csv2json.js"></script>
   <script src="datesandcats.js"></script>
   <script src="past.js"></script>
   <script src="filter.js"></script>
	</head>
	<body>
    <input type='file' accept='text/plain' onchange='openFile(event)'><br>
    <img id='output'>
    <a id="downloadAnchorElem" style="display:none"></a>
    <script>
    /*
      var openFile = function(event) {
        var input = event.target;

        var reader = new FileReader();
        reader.onload = function(){
          var text = reader.result;
          console.log(reader.result.substring(0, 200));
        };
        reader.readAsText(input.files[0]);
        reader.onloadend = function () {
            console.log('DONE', reader.readyState);
            printo(parse(reader.result));
        };
      };
      */
      var dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(generate(init,past,filter),null, "\t"));
      var dlAnchorElem = document.getElementById('downloadAnchorElem');
      dlAnchorElem.setAttribute("href",     dataStr     );
      dlAnchorElem.setAttribute("download", "scene.stack");
      dlAnchorElem.click();
      console.log(generate(init,past,filter));
      printo(generate(init,past,filter));
    </script>
  </body>
</html>
